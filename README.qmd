---
title: "Progress Report" 
author: "William & Sebastian" 
format: gfm 
editor: visual
---

## Research Question

-   What is the impact of air pollution caused by light rail stations on demographics in Phoenix and Mesa?

## Hypothesis

-   The Light Rail in Phoenix-Mesa should help alleviate the amount of PM2.5 being released into the air, helping decrease air quality diseases around the area. Phoenix-Mesa has seen an increase of population, it has had a 16.31% increase in population from 2004 to 2012, increasing further more as the years progress. this increase in population is enough to congest roads and increase demand in power to provide to the citizens. All of this can increase the levels in PM2.5. the light rail will help alleviate by providing a faster, community transportation that would decrease the amount of cars in the streets. With less cars in the streets, roads can help decongest faster. So Overall, the impact of the light rail to the air pollution in the Phoenix-Mesa region (Maricopa County) will increase as more people use the light rail, further reducing one of their biggest contributors of PM2.5 polluters.

## Data

```{r}
library("tidyverse") 
library("knitr") 
library("terra") 
library("maptiles")
```

-   Timeline of interest

    -   Given the time frame of the data we have access to from NASA, the only stations that existed then all opened in December 27th 2008. We want to track the pollution in an equal timeframe before and after the opening, so we chose the timeframe of January 1st 2004 to January 1st 2012

-   Station locations

    -   We used a Google API key in order to collect the coordinates of each of these stations, manually collecting the few that Google didn't automatically find.

        ```{r}
        c<-read.csv("Coordinates.csv") %>%   
          select(Station, lat2, lon2) 
        kable(c)
        ```

-   Factors that impact PM2.5 in the city

    There are many factors that contribute to the PM2.5 level in the air in Maricopa County, this is the Phoenix-Mesa area we are focusing on. According to their Maricopa's official website, some of the biggest contributors of PM2.5 pollution include wood burning, power plants, congested highways, construction sites, unpaved roads. Using the same technique of acquiring their coordinates from Google API, we are able to make a table that contains some of the biggest contributors around this county, some more centralized in the city than others..

```{r}
sources <- read.csv("Poll_Coordinates.csv") %>%     
  filter(Source != "SOURCE Arizona") %>%     
  select(Source,lat2,lon2) 
kable(sources) 
```

## Plotting Stations

Once we had the coordinates, we could plot them out and create a map displaying the stations and the line they all service, as well as a circular buffer representing the station's area of effect.

```{r}
stations <- read.csv("Coordinates.csv") 
sources <- read.csv("Poll_Coordinates.csv")  
df<-stations |>   select(lon2, lat2)  
df2<-sources |>   select(lon2, lat2)  
#converts df into a spatvector 
x <- vect(df, geom=c("lon2", "lat2"), crs="+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs ") 
y <- vect(df2, geom=c("lon2", "lat2"), crs="+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs ") 
#these are the stations  plot(x) #these are our sources of Pollution in Maricopa County 
plot(y) 
```

This would then put buffers over our stations with a 1000m radius. Combining together a map background along with our points and their stations buffers, we get a more complete map.

```{r}
#create a 1 km (1000 meter) buffer (radius)  
pts_buffer<-buffer(x, width = 400) 
plot(pts_buffer)   
#approximate size of the background 
extent<-buffer(x, width = 400)  
bg <- get_tiles(ext(extent))  
plot(bg)  
#plotting the Stations and their buffers ,as well as sources of pollution 
lines(pts_buffer) 
points(x, col = "red") 
points(y, col = "blue") 
outfile <- "buffer.shp" 
writeVector(pts_buffer, outfile, overwrite=TRUE) 
```
